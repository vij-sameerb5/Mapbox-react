{"ast":null,"code":"var _jsxFileName = \"/Users/sameershaik/Desktop/mapbox-react/src/mapbox-gl/MapboxGl.js\",\n  _s = $RefreshSig$();\n// src/mapbox-gl/MapboxGl.js\nimport React, { useEffect, useRef } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport '../App.css';\n\n// Ensure your token is set in .env: REACT_APP_MAPBOX_TOKEN\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nmapboxgl.accessToken = process.env.REACT_APP_MAPBOX_TOKEN;\nexport default function MapboxGl() {\n  _s();\n  // Define the ref for the map container!\n  const mapContainerRef = useRef(null);\n  const mapRef = useRef(null);\n  const popupRef = useRef(new mapboxgl.Popup({\n    closeButton: false,\n    closeOnClick: true\n  }));\n  useEffect(() => {\n    // Initialize the map only once\n    mapRef.current = new mapboxgl.Map({\n      container: mapContainerRef.current,\n      style: 'mapbox://styles/mapbox/standard-satellite',\n      zoom: 1.5,\n      center: [-90, 40],\n      projection: 'globe',\n      antialias: true\n    });\n    const map = mapRef.current;\n    map.on('style.load', () => {\n      map.setFog({});\n\n      // Fetch earthquakes (past 30 days, M ≥ 5)\n      const past30 = new Date(Date.now() - 30 * 24 * 3600 * 1000).toISOString().split('T')[0];\n      fetch(`https://earthquake.usgs.gov/fdsnws/event/1/query?format=geojson&starttime=${past30}&minmagnitude=5`).then(res => res.json()).then(data => {\n        // Add source & layer\n        map.addSource('earthquakes', {\n          type: 'geojson',\n          data\n        });\n        map.addLayer({\n          id: 'quake-circles',\n          type: 'circle',\n          source: 'earthquakes',\n          paint: {\n            'circle-radius': ['interpolate', ['linear'], ['get', 'mag'], 5, 6, 8, 12, 10, 20],\n            'circle-color': '#E55E5E',\n            'circle-stroke-color': '#FFF',\n            'circle-stroke-width': 1,\n            'circle-opacity': 0.8\n          }\n        });\n\n        // Popups\n        map.on('click', 'quake-circles', ev => {\n          const {\n            place,\n            mag,\n            time\n          } = ev.features[0].properties;\n          const date = new Date(time).toLocaleString();\n          popupRef.current.setLngLat(ev.lngLat).setHTML(`<strong>${place}</strong><br/>Mag: ${mag.toFixed(1)}<br/>${date}`).addTo(map);\n        });\n        map.on('mouseenter', 'quake-circles', () => map.getCanvas().style.cursor = 'pointer');\n        map.on('mouseleave', 'quake-circles', () => map.getCanvas().style.cursor = '');\n      }).catch(err => console.error('USGS fetch error:', err));\n\n      // Spin logic\n      initSpin(map);\n    });\n\n    // Cleanup on unmount\n    return () => {\n      var _mapRef$current;\n      return (_mapRef$current = mapRef.current) === null || _mapRef$current === void 0 ? void 0 : _mapRef$current.remove();\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      ref: mapContainerRef,\n      id: \"map\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      id: \"btn-spin\",\n      children: \"Pause rotation\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n// Spin initialization extracted for clarity\n_s(MapboxGl, \"cNIaSTIvtUB/qz6PW3pfvAN+Xw4=\");\n_c = MapboxGl;\nfunction initSpin(map) {\n  const secondsPerRevolution = 120;\n  const maxSpinZoom = 5;\n  const slowSpinZoom = 3;\n  let userInteracting = false;\n  let spinEnabled = true;\n  function spinGlobe() {\n    const zoom = map.getZoom();\n    if (!spinEnabled || userInteracting || zoom >= maxSpinZoom) return;\n    let speed = 360 / secondsPerRevolution;\n    if (zoom > slowSpinZoom) {\n      speed *= (maxSpinZoom - zoom) / (maxSpinZoom - slowSpinZoom);\n    }\n    const center = map.getCenter();\n    center.lng -= speed;\n    map.easeTo({\n      center,\n      duration: 1000,\n      easing: t => t\n    });\n  }\n  ['mousedown', 'dragstart', 'zoomstart', 'rotatestart', 'pitchstart'].forEach(e => map.on(e, () => {\n    userInteracting = true;\n  }));\n  ['mouseup', 'dragend', 'zoomend', 'rotateend', 'pitchend'].forEach(e => map.on(e, () => {\n    userInteracting = false;\n    spinGlobe();\n  }));\n  map.on('moveend', spinGlobe);\n  document.getElementById('btn-spin').addEventListener('click', evt => {\n    spinEnabled = !spinEnabled;\n    if (spinEnabled) {\n      spinGlobe();\n      evt.target.textContent = 'Pause rotation';\n    } else {\n      map.stop();\n      evt.target.textContent = 'Start rotation';\n    }\n  });\n  spinGlobe();\n}\nvar _c;\n$RefreshReg$(_c, \"MapboxGl\");","map":{"version":3,"names":["React","useEffect","useRef","mapboxgl","jsxDEV","_jsxDEV","Fragment","_Fragment","accessToken","process","env","REACT_APP_MAPBOX_TOKEN","MapboxGl","_s","mapContainerRef","mapRef","popupRef","Popup","closeButton","closeOnClick","current","Map","container","style","zoom","center","projection","antialias","map","on","setFog","past30","Date","now","toISOString","split","fetch","then","res","json","data","addSource","type","addLayer","id","source","paint","ev","place","mag","time","features","properties","date","toLocaleString","setLngLat","lngLat","setHTML","toFixed","addTo","getCanvas","cursor","catch","err","console","error","initSpin","_mapRef$current","remove","children","ref","fileName","_jsxFileName","lineNumber","columnNumber","_c","secondsPerRevolution","maxSpinZoom","slowSpinZoom","userInteracting","spinEnabled","spinGlobe","getZoom","speed","getCenter","lng","easeTo","duration","easing","t","forEach","e","document","getElementById","addEventListener","evt","target","textContent","stop","$RefreshReg$"],"sources":["/Users/sameershaik/Desktop/mapbox-react/src/mapbox-gl/MapboxGl.js"],"sourcesContent":["// src/mapbox-gl/MapboxGl.js\nimport React, { useEffect, useRef } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport '../App.css';\n\n// Ensure your token is set in .env: REACT_APP_MAPBOX_TOKEN\nmapboxgl.accessToken = process.env.REACT_APP_MAPBOX_TOKEN;\n\nexport default function MapboxGl() {\n  // Define the ref for the map container!\n  const mapContainerRef = useRef(null);\n  const mapRef = useRef(null);\n  const popupRef = useRef(\n    new mapboxgl.Popup({ closeButton: false, closeOnClick: true })\n  );\n\n  useEffect(() => {\n    // Initialize the map only once\n    mapRef.current = new mapboxgl.Map({\n      container: mapContainerRef.current,\n      style: 'mapbox://styles/mapbox/standard-satellite',\n      zoom: 1.5,\n      center: [-90, 40],\n      projection: 'globe',\n      antialias: true,\n    });\n\n    const map = mapRef.current;\n\n    map.on('style.load', () => {\n      map.setFog({});\n\n      // Fetch earthquakes (past 30 days, M ≥ 5)\n      const past30 = new Date(Date.now() - 30 * 24 * 3600 * 1000)\n        .toISOString()\n        .split('T')[0];\n\n      fetch(\n        `https://earthquake.usgs.gov/fdsnws/event/1/query?format=geojson&starttime=${past30}&minmagnitude=5`\n      )\n        .then(res => res.json())\n        .then(data => {\n          // Add source & layer\n          map.addSource('earthquakes', { type: 'geojson', data });\n          map.addLayer({\n            id: 'quake-circles',\n            type: 'circle',\n            source: 'earthquakes',\n            paint: {\n              'circle-radius': [\n                'interpolate', ['linear'], ['get', 'mag'],\n                5, 6, 8, 12, 10, 20\n              ],\n              'circle-color': '#E55E5E',\n              'circle-stroke-color': '#FFF',\n              'circle-stroke-width': 1,\n              'circle-opacity': 0.8,\n            },\n          });\n\n          // Popups\n          map.on('click', 'quake-circles', ev => {\n            const { place, mag, time } = ev.features[0].properties;\n            const date = new Date(time).toLocaleString();\n            popupRef.current\n              .setLngLat(ev.lngLat)\n              .setHTML(\n                `<strong>${place}</strong><br/>Mag: ${mag.toFixed(1)}<br/>${date}`\n              )\n              .addTo(map);\n          });\n          map.on('mouseenter', 'quake-circles', () =>\n            map.getCanvas().style.cursor = 'pointer'\n          );\n          map.on('mouseleave', 'quake-circles', () =>\n            map.getCanvas().style.cursor = ''\n          );\n        })\n        .catch(err => console.error('USGS fetch error:', err));\n\n      // Spin logic\n      initSpin(map);\n    });\n\n    // Cleanup on unmount\n    return () => mapRef.current?.remove();\n  }, []);\n\n  return (\n    <>\n      <div ref={mapContainerRef} id=\"map\" />\n      <button id=\"btn-spin\">Pause rotation</button>\n    </>\n  );\n}\n\n// Spin initialization extracted for clarity\nfunction initSpin(map) {\n  const secondsPerRevolution = 120;\n  const maxSpinZoom = 5;\n  const slowSpinZoom = 3;\n  let userInteracting = false;\n  let spinEnabled = true;\n\n  function spinGlobe() {\n    const zoom = map.getZoom();\n    if (!spinEnabled || userInteracting || zoom >= maxSpinZoom) return;\n    let speed = 360 / secondsPerRevolution;\n    if (zoom > slowSpinZoom) {\n      speed *= (maxSpinZoom - zoom) / (maxSpinZoom - slowSpinZoom);\n    }\n    const center = map.getCenter();\n    center.lng -= speed;\n    map.easeTo({ center, duration: 1000, easing: t => t });\n  }\n\n  ['mousedown','dragstart','zoomstart','rotatestart','pitchstart']\n    .forEach(e => map.on(e, () => { userInteracting = true; }));\n  ['mouseup','dragend','zoomend','rotateend','pitchend']\n    .forEach(e => map.on(e, () => { userInteracting = false; spinGlobe(); }));\n  map.on('moveend', spinGlobe);\n\n  document.getElementById('btn-spin')\n    .addEventListener('click', evt => {\n      spinEnabled = !spinEnabled;\n      if (spinEnabled) {\n        spinGlobe();\n        evt.target.textContent = 'Pause rotation';\n      } else {\n        map.stop();\n        evt.target.textContent = 'Start rotation';\n      }\n    });\n\n  spinGlobe();\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}