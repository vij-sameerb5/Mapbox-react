{"ast":null,"code":"'use strict';\n\nvar MapiResponse = require('../classes/mapi-response');\nvar MapiError = require('../classes/mapi-error');\nvar constants = require('../constants');\nvar parseHeaders = require('../helpers/parse-headers');\n\n// Keys are request IDs, values are XHRs.\nvar requestsUnderway = {};\nfunction browserAbort(request) {\n  var xhr = requestsUnderway[request.id];\n  if (!xhr) return;\n  xhr.abort();\n  delete requestsUnderway[request.id];\n}\nfunction createResponse(request, xhr) {\n  return new MapiResponse(request, {\n    body: xhr.response,\n    headers: parseHeaders(xhr.getAllResponseHeaders()),\n    statusCode: xhr.status\n  });\n}\nfunction normalizeBrowserProgressEvent(event) {\n  var total = event.total;\n  var transferred = event.loaded;\n  var percent = 100 * transferred / total;\n  return {\n    total: total,\n    transferred: transferred,\n    percent: percent\n  };\n}\nfunction sendRequestXhr(request, xhr) {\n  return new Promise(function (resolve, reject) {\n    xhr.onprogress = function (event) {\n      request.emitter.emit(constants.EVENT_PROGRESS_DOWNLOAD, normalizeBrowserProgressEvent(event));\n    };\n    var file = request.file;\n    if (file) {\n      xhr.upload.onprogress = function (event) {\n        request.emitter.emit(constants.EVENT_PROGRESS_UPLOAD, normalizeBrowserProgressEvent(event));\n      };\n    }\n    xhr.onerror = function (error) {\n      reject(error);\n    };\n    xhr.onabort = function () {\n      var mapiError = new MapiError({\n        request: request,\n        type: constants.ERROR_REQUEST_ABORTED\n      });\n      reject(mapiError);\n    };\n    xhr.onload = function () {\n      delete requestsUnderway[request.id];\n      if (xhr.status < 200 || xhr.status >= 400) {\n        var mapiError = new MapiError({\n          request: request,\n          body: xhr.response,\n          statusCode: xhr.status\n        });\n        reject(mapiError);\n        return;\n      }\n      resolve(xhr);\n    };\n    var body = request.body;\n\n    // matching service needs to send a www-form-urlencoded request\n    if (typeof body === 'string') {\n      xhr.send(body);\n    } else if (body) {\n      xhr.send(JSON.stringify(body));\n    } else if (file) {\n      xhr.send(file);\n    } else {\n      xhr.send();\n    }\n    requestsUnderway[request.id] = xhr;\n  }).then(function (xhr) {\n    return createResponse(request, xhr);\n  });\n}\n\n// The accessToken argument gives this function flexibility\n// for Mapbox's internal client.\nfunction createRequestXhr(request, accessToken) {\n  var url = request.url(accessToken);\n  var xhr = new window.XMLHttpRequest();\n  xhr.open(request.method, url);\n  Object.keys(request.headers).forEach(function (key) {\n    xhr.setRequestHeader(key, request.headers[key]);\n  });\n  return xhr;\n}\nfunction browserSend(request) {\n  return Promise.resolve().then(function () {\n    var xhr = createRequestXhr(request, request.client.accessToken);\n    return sendRequestXhr(request, xhr);\n  });\n}\nmodule.exports = {\n  browserAbort: browserAbort,\n  sendRequestXhr: sendRequestXhr,\n  browserSend: browserSend,\n  createRequestXhr: createRequestXhr\n};","map":{"version":3,"names":["MapiResponse","require","MapiError","constants","parseHeaders","requestsUnderway","browserAbort","request","xhr","id","abort","createResponse","body","response","headers","getAllResponseHeaders","statusCode","status","normalizeBrowserProgressEvent","event","total","transferred","loaded","percent","sendRequestXhr","Promise","resolve","reject","onprogress","emitter","emit","EVENT_PROGRESS_DOWNLOAD","file","upload","EVENT_PROGRESS_UPLOAD","onerror","error","onabort","mapiError","type","ERROR_REQUEST_ABORTED","onload","send","JSON","stringify","then","createRequestXhr","accessToken","url","window","XMLHttpRequest","open","method","Object","keys","forEach","key","setRequestHeader","browserSend","client","module","exports"],"sources":["/Users/sameershaik/Desktop/mapbox-react/node_modules/@mapbox/mapbox-sdk/lib/browser/browser-layer.js"],"sourcesContent":["'use strict';\n\nvar MapiResponse = require('../classes/mapi-response');\nvar MapiError = require('../classes/mapi-error');\nvar constants = require('../constants');\nvar parseHeaders = require('../helpers/parse-headers');\n\n// Keys are request IDs, values are XHRs.\nvar requestsUnderway = {};\n\nfunction browserAbort(request) {\n  var xhr = requestsUnderway[request.id];\n  if (!xhr) return;\n  xhr.abort();\n  delete requestsUnderway[request.id];\n}\n\nfunction createResponse(request, xhr) {\n  return new MapiResponse(request, {\n    body: xhr.response,\n    headers: parseHeaders(xhr.getAllResponseHeaders()),\n    statusCode: xhr.status\n  });\n}\n\nfunction normalizeBrowserProgressEvent(event) {\n  var total = event.total;\n  var transferred = event.loaded;\n  var percent = (100 * transferred) / total;\n  return {\n    total: total,\n    transferred: transferred,\n    percent: percent\n  };\n}\n\nfunction sendRequestXhr(request, xhr) {\n  return new Promise(function(resolve, reject) {\n    xhr.onprogress = function(event) {\n      request.emitter.emit(\n        constants.EVENT_PROGRESS_DOWNLOAD,\n        normalizeBrowserProgressEvent(event)\n      );\n    };\n\n    var file = request.file;\n    if (file) {\n      xhr.upload.onprogress = function(event) {\n        request.emitter.emit(\n          constants.EVENT_PROGRESS_UPLOAD,\n          normalizeBrowserProgressEvent(event)\n        );\n      };\n    }\n\n    xhr.onerror = function(error) {\n      reject(error);\n    };\n\n    xhr.onabort = function() {\n      var mapiError = new MapiError({\n        request: request,\n        type: constants.ERROR_REQUEST_ABORTED\n      });\n      reject(mapiError);\n    };\n\n    xhr.onload = function() {\n      delete requestsUnderway[request.id];\n      if (xhr.status < 200 || xhr.status >= 400) {\n        var mapiError = new MapiError({\n          request: request,\n          body: xhr.response,\n          statusCode: xhr.status\n        });\n        reject(mapiError);\n        return;\n      }\n      resolve(xhr);\n    };\n\n    var body = request.body;\n\n    // matching service needs to send a www-form-urlencoded request\n    if (typeof body === 'string') {\n      xhr.send(body);\n    } else if (body) {\n      xhr.send(JSON.stringify(body));\n    } else if (file) {\n      xhr.send(file);\n    } else {\n      xhr.send();\n    }\n\n    requestsUnderway[request.id] = xhr;\n  }).then(function(xhr) {\n    return createResponse(request, xhr);\n  });\n}\n\n// The accessToken argument gives this function flexibility\n// for Mapbox's internal client.\nfunction createRequestXhr(request, accessToken) {\n  var url = request.url(accessToken);\n  var xhr = new window.XMLHttpRequest();\n  xhr.open(request.method, url);\n  Object.keys(request.headers).forEach(function(key) {\n    xhr.setRequestHeader(key, request.headers[key]);\n  });\n  return xhr;\n}\n\nfunction browserSend(request) {\n  return Promise.resolve().then(function() {\n    var xhr = createRequestXhr(request, request.client.accessToken);\n    return sendRequestXhr(request, xhr);\n  });\n}\n\nmodule.exports = {\n  browserAbort: browserAbort,\n  sendRequestXhr: sendRequestXhr,\n  browserSend: browserSend,\n  createRequestXhr: createRequestXhr\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}